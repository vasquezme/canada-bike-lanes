<!DOCTYPE html>
<html>
<head>
<title>Bike Lanes in Canada's Major Cities</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">

<!-- Load Leaflet code library: see https://leafletjs.com/download.html -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js" integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>

<!-- Position the map and title with Cascading Style Sheet (CSS) -->
<style>
body { margin:0; padding:0; }
#map { position: absolute; top:0; bottom:0; right:0; left:0; }
#map-title { position: relative; margin-top: 10px; margin-left: 50px; float: left; background: white; border: 2px solid rgba(0,0,0,0.2); padding: 6px 8px; font-family: Helvetica; font-weight: bold; font-size: 24px; z-index: 800; }
</style>
</head>
<body>

<!-- Display the map and title with HTML division tags  -->
<div id="map-title">Bike Lanes in Canada's Major Cities</div>
<div id="map"></div>

<!-- Create the interactive map content with JavaScript (.js) -->
<script>

/* Set up the initial map center and zoom level */
var map = L.map('map', {
center: [43.71, -79.35], // EDIT coordinates to re-center map 43.71884937166963, -79.35702332750493
zoom: 14,  // EDIT from 1 (zoomed out) to 18 (zoomed in)
scrollWheelZoom: false
});

/* display basemap tiles -- see others at https://leaflet-extras.github.io/leaflet-providers/preview/ */
L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { // https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}
attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
}).addTo(map);
  

/* Fetch cyclenetworks */
fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/toronto-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/vancouver-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/barrie-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/calgary-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/edmonton-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/halifax-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/montreal-cyclenetwork2.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/ottawa-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  /* Fetch weather information and icon from api */
  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Toronto&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([43.64, -79.38], {
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Toronto Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Barrie&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([44.38, -79.69], { // 44.386829642976195, -79.69346212628673
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Barrie Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Ottawa&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([45.41, -75.71], { // 45.41332792885776, -75.71140008000337
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Ottawa Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Montreal&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([45.50, -73.65], { // 45.508067706325434, -73.65730186543742
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Montreal Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Halifax&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([44.65, -63.60], { // 44.65354030982758, -63.60660294597673
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Halifax Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Edmonton&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([53.53, -113.50], { // 53.53700964973494, -113.50326527442228
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Edmonton Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));
  
  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Calgary&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([51.05, -114.06], { // 51.05710121338244, -114.06639970031554
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Calgary Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  fetch('https://api.weatherapi.com/v1/forecast.json?key=83ac127a35ea45fb861221643251504&q=Vancouver&days=1&aqi=no&alerts=no')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.current.temp_c; // Temperature in Celsius
    var desc = data.current.condition.text; // Description of weather
    var iconUrl = "https:" + data.current.condition.icon; // Weather icon
    
    L.marker([49.26, -123.12], { // 49.26526390119565, -123.12974636763072
      icon: L.icon({ iconUrl, iconSize: [100, 100] })
    }).addTo(map)
    .bindPopup(`Vancouver Weather: ${desc}, ${temp}°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));

  
</script>
</body>
</html>
