<!DOCTYPE html>
<html>
<head>
<title>Bike Lanes in Canada's Major Cities</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">

<!-- Load Leaflet code library: see https://leafletjs.com/download.html -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js" integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>

<!-- Position the map and title with Cascading Style Sheet (CSS) -->
<style>
body { margin:0; padding:0; }
#map { position: absolute; top:0; bottom:0; right:0; left:0; }
#map-title { position: relative; margin-top: 10px; margin-left: 50px; float: left; background: white; border: 2px solid rgba(0,0,0,0.2); padding: 6px 8px; font-family: Helvetica; font-weight: bold; font-size: 24px; z-index: 800; }
</style>
</head>
<body>

<!-- Display the map and title with HTML division tags  -->
<div id="map-title">Bike Lanes in Canada's Major Cities</div>
<div id="map"></div>

<!-- Create the interactive map content with JavaScript (.js) -->
<script>

/* Set up the initial map center and zoom level */
var map = L.map('map', {
center: [43.71, -79.35], // EDIT coordinates to re-center map 43.71884937166963, -79.35702332750493
zoom: 14,  // EDIT from 1 (zoomed out) to 18 (zoomed in)
scrollWheelZoom: false
});

/* display basemap tiles -- see others at https://leaflet-extras.github.io/leaflet-providers/preview/ */
L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { // https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}
attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
}).addTo(map);

fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/toronto-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/vancouver-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/barrie-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/calgary-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/edmonton-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/halifax-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/montreal-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://raw.githubusercontent.com/vasquezme/canada-bike-lanes/refs/heads/main/bike-lanes-network/ottawa-cyclenetwork.json')
  .then(response => response.json()) // Parse JSON
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        return { color: 'blue', weight: 5 };
      },
      onEachFeature: function(feature, layer) {
        layer.bindPopup("Street: " + feature.properties.STREET_NAME);
      }
    }).addTo(map);
  })
  .catch(error => console.error('Error loading GeoJSON:', error));

  fetch('https://api.openweathermap.org/data/2.5/weather?lat=43.64&lon=-79.38&appid=58526aa7768dffbc6664bb192605673f')
  .then(response => response.json())
  .then(data => {
    console.log(data); // Check API response
    var temp = data.main.temp - 273.15; // Convert Kelvin to Celsius
    var desc = data.weather[0].description;

    L.marker([43.64, -79.38])
      .addTo(map)
      .bindPopup(`Toronto Weather: ${desc}, ${temp.toFixed(1)}Â°C`);
  })
  .catch(error => console.error('Error fetching weather data:', error));
  
</script>
</body>
</html>
